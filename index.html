<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUCIDITY - AI Content Analysis System</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=IBM+Plex+Mono:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #00ff9d;
            --secondary: #0066ff;
            --accent: #ff00ff;
            --dark: #0a0e1a;
            --darker: #050810;
            --light: #e8f4f8;
            --warning: #ffaa00;
            --danger: #ff3366;
            --success: #00ff9d;
            --glow-primary: 0 0 20px rgba(0, 255, 157, 0.3);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'IBM Plex Mono', monospace; background: var(--darker); color: var(--light); min-height: 100vh; }
        .container { max-width: 1400px; margin: 0 auto; padding: 2rem; }
        
        header { text-align: center; margin-bottom: 4rem; padding: 3rem 0; }
        h1 { font-family: 'Orbitron', sans-serif; font-size: 4rem; background: linear-gradient(135deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; letter-spacing: 0.1em; }
        
        .upload-section { background: rgba(10, 14, 26, 0.9); border: 2px solid rgba(0, 255, 157, 0.2); border-radius: 20px; padding: 3rem; margin-bottom: 3rem; box-shadow: var(--glow-primary); }
        textarea { width: 100%; min-height: 200px; background: #050810; border: 2px solid #0044cc; border-radius: 10px; padding: 1.5rem; color: white; margin-top: 1rem; }
        
        .btn-group { display: flex; gap: 1rem; margin-top: 1.5rem; }
        .btn { font-family: 'Orbitron', sans-serif; padding: 1rem 2rem; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; text-transform: uppercase; }
        .btn-primary { background: var(--primary); color: var(--dark); }
        
        /* BEAT MAP SPECIFIC CSS */
        .beat-map-container { background: #0a0e1a; padding: 25px; border-radius: 12px; border: 1px solid #333; margin-top: 20px; }
        .beat-grid { display: grid; grid-template-columns: repeat(20, 1fr); gap: 6px; height: 40px; margin: 20px 0; }
        .beat-block { border-radius: 3px; transition: all 0.3s ease; position: relative; }
        .beat-block:hover::after { content: attr(title); position: absolute; bottom: 50px; left: 50%; transform: translateX(-50%); background: black; padding: 5px; font-size: 10px; white-space: nowrap; z-index: 100; border: 1px solid var(--primary); }
        
        .results-section { display: none; }
        .results-section.active { display: block; }
        .tabs { display: flex; gap: 10px; border-bottom: 2px solid #222; margin-bottom: 20px; }
        .tab { padding: 15px; background: transparent; color: #666; border: none; cursor: pointer; font-family: 'Orbitron'; font-size: 0.8rem; }
        .tab.active { color: var(--primary); border-bottom: 2px solid var(--primary); }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        .score-card { background: #0f172a; padding: 30px; border-radius: 20px; margin-bottom: 20px; border: 1px solid #1e293b; }
        .score-value { font-family: 'Orbitron'; font-size: 3.5rem; color: var(--primary); }

        footer { text-align: center; margin-top: 50px; opacity: 0.6; font-size: 0.8rem; padding-bottom: 40px; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>LUCIDITY</h1>
            <div style="letter-spacing: 0.5em; color: var(--secondary)">POWERED BY ACTS</div>
        </header>
        
        <div class="upload-section">
            <textarea id="textInput" placeholder="Paste content for real-time Beat Map analysis..."></textarea>
            <div class="btn-group">
                <button class="btn btn-primary" id="analyzeBtn">⚡ RUN DIAGNOSTIC</button>
                <button class="btn" style="background:#333; color:white;" id="clearBtn">RESET</button>
            </div>
        </div>
        
        <div class="results-section" id="resultsSection">
            <div class="score-card">
                <div style="font-size: 0.8rem; letter-spacing: 2px; color: var(--secondary);">LUCIDITY INDEX</div>
                <div class="score-value" id="overallScore">0.00</div>
                <div id="statusBadge" style="display:inline-block; padding: 5px 15px; border-radius: 20px; font-size: 0.7rem; font-weight: bold;"></div>
            </div>

            <div class="tabs">
                <button class="tab active" data-tab="beatmap">BEAT MAP</button>
                <button class="tab" data-tab="vectors">VECTORS</button>
                <button class="tab" data-tab="protocol">PROTOCOL</button>
            </div>

            <div class="tab-content active" id="beatmap">
                <div class="beat-map-container">
                    <div style="font-size: 0.7rem; color: #aaa; letter-spacing: 1px; text-transform: uppercase;">Temporal Flow Analysis (20-Segment Distribution)</div>
                    <div class="beat-grid" id="beatGrid"></div>
                    <div id="beatInsights" style="font-size: 0.85rem; border-left: 3px solid var(--primary); padding-left: 15px; color: #ccc;"></div>
                </div>
            </div>

            <div class="tab-content" id="vectors">
                <div id="vectorDetails" style="background:#0a0e1a; padding:20px; border-radius:10px;"></div>
            </div>

            <div class="tab-content" id="protocol">
                <div id="protocolItems" style="background:#0a0e1a; padding:20px; border-radius:10px; color: var(--accent);"></div>
            </div>
        </div>

        <footer>
            PROPRIETARY ACTS ENGINE • ZADEO INC • PROVISIONAL PATENTS PENDING
        </footer>
    </div>

    <script>
        class LUCIDITYEngine {
            analyze(text) {
                const words = text.toLowerCase().match(/\b(\w+)\b/g) || [];
                const chunks = this.splitIntoChunks(words, 20);
                
                // Real Repetition Check
                const uniqueRatio = new Set(words).size / (words.length || 1);
                const baseScore = Math.min(100, uniqueRatio * 130);

                // Segment Analysis for Beat Map
                const segmentScores = chunks.map(chunk => {
                    const unique = new Set(chunk).size;
                    return chunk.length > 0 ? (unique / chunk.length) : 1;
                });

                return {
                    overall: baseScore.toFixed(2),
                    segments: segmentScores,
                    wordCount: words.length
                };
            }

            splitIntoChunks(array, parts) {
                let result = [];
                for (let i = parts; i > 0; i--) {
                    result.push(array.splice(0, Math.ceil(array.length / i)));
                }
                return result;
            }
        }

        const engine = new LUCIDITYEngine();

        document.getElementById('analyzeBtn').addEventListener('click', () => {
            const text = document.getElementById('textInput').value;
            if(!text) return alert("Paste text first");

            const results = engine.analyze(text);
            
            // UI Update
            document.getElementById('overallScore').innerText = results.overall;
            document.getElementById('resultsSection').classList.add('active');
            
            const badge = document.getElementById('statusBadge');
            if(results.overall > 80) {
                badge.innerText = "HEALTHY"; badge.style.background = "rgba(0,255,157,0.2)"; badge.style.color = "var(--primary)";
            } else {
                badge.innerText = "DEGRADED"; badge.style.background = "rgba(255,51,102,0.2)"; badge.style.color = "var(--danger)";
            }

            // Draw Beat Map
            const grid = document.getElementById('beatGrid');
            grid.innerHTML = '';
            results.segments.forEach((s, i) => {
                const block = document.createElement('div');
                block.className = 'beat-block';
                const intensity = s * 100;
                block.style.background = intensity > 80 ? 'var(--primary)' : (intensity > 50 ? 'var(--warning)' : 'var(--danger)');
                block.title = `Segment ${i+1}: ${intensity.toFixed(1)}% integrity`;
                grid.appendChild(block);
            });

            document.getElementById('beatInsights').innerText = results.overall < 70 ? 
                "CRITICAL: Structural collapse detected in specific segments. High convergence risk." : 
                "NOMINAL: Information density maintained across temporal segments.";
        });

        // Tab Logic
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                document.querySelectorAll('.tab, .tab-content').forEach(el => el.classList.remove('active'));
                tab.classList.add('active');
                document.getElementById(tab.dataset.tab).classList.add('active');
            });
        });

        document.getElementById('clearBtn').addEventListener('click', () => location.reload());
    </script>
</body>
</html>
